<!DOCTYPE html>
<% var fs = require('fs') %>
<% var spawnSync = require('child_process').spawnSync %>
<html>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="/base.css" />
    <link rel="stylesheet" id="style" />
    <link rel="icon" href="/favicon.png" />
    <title>-</title>
  </head>
  <body>
    <% if (!data.frames.length) data.frames = ['src/index.md']; data.frames.forEach(function(frame, index) { %>
       <div class="region--frame region--frame--<%- frame.replace(/[^_a-zA-Z0-9-]+/g, '_') %>">
         <div class="region--frame-inner">
           <% if (frame.match('pandoc') !== null) { %>
           <%- spawnSync('pandoc', ['--from=markdown', '--to=html', frame]).stdout -%>
           <% } else { %>
             <%- marked(fs.readFileSync(frame).toString()) -%>
           <% } %>
         </div>
       </div>
       <% if (data.frames.length  > 1 && index % 2 === 0) { %>
         <div class="ctl--handle"></div>
       <% } %>
    <% }); %>

    <select class="ctl--styleChanger">
      <option value="">none</option>

      <% data.styles.forEach(function(style, index) { %>
        <option value=<%= style %>><%=style %></option>
      <% }); %>

    </select>
    <script src="scripts/drag.js"></script>
    <script src="scripts/handleStyleChange.js"></script>
    <script src="scripts/ResizeSensor.js"></script>
    <script src="scripts/ElementQueries.js"></script>
  </body>
</html>
